. ./list.sh

NONE='\033[00m'
RED='\033[01;31m'
GREEN='\033[01;32m'
BOLD='\033[1m'
passed=0
failed=0

check() {
  code=$1
  returns=$2
  if [ "$($code)" = "$returns" ]; then
    passed=$(expr 1 + $passed)
  else
    echo "\
${BOLD}Runing:${NONE}\n$code
${BOLD}Expected:${NONE}\n$returns
${BOLD}Got:${NONE}\n$($code)"
    failed=$(expr 1 + $failed)
  fi
}

printresult() {
  linewidth=$(stty size | awk '{print $2}')
  if [ $failed = 0 ]; then
    message=" $passed passed "
    echo -n $GREEN
  else
    message=" $failed failed, $passed passed "
    echo -n $RED
  fi
  nequals="$(seq 1 $((($linewidth - $(expr length "$message")) / 2)))"
  echo -n $BOLD
  for i in $nequals; do echo -n =; done
  echo -n "$message"
  for i in $nequals; do echo -n =; done
  echo $NONE
}

check "list 1 2" "\
1
2"

# check "list 4 5 6 | apply 1" "5"

printresult
